# Entity alias mappings - user terms to normalized entities
aliases:
  # Cable Modem mappings
  cm:
    - "cable modem"
    - "modem"
    - "CM"
    - "cablemodem"
    - "CmMacAddress"
    - "cm_mac"
    - "cm mac address"
    - "CmIpAddress"
    - "cm_ip_address"
    - "cm ip address"
  
  md_id:
    - "MdId"
    - "md-id"
    - "md_id"
    - "mac domain id"
    - "mac domain"
  
  cpe:
    - "CPE"
    - "customer premise equipment"
    - "cpe_mac"
    - "CpeMacAddress"
    - "CpeIpAddress"
    - "cpe_ip_address"
    - "cpe ip address"
  
  rpdname:
    - "rpd_name"
    - "rpd name"
    - "RpdName"
    - "RPD"
    - "RpdIpAddress"
    - "rpd_ip_address"
    - "rpd ip address"
  
  sf_id:
    - "service_flow_id"
    - "service flow id"
    - "SfId"
    - "SFID"
  
  # Package/Service mappings
  package:
    - "pkg"
    - "service"
    - "plan"
    - "Package"
  
  # Error/Issue mappings
  error:
    - "err"
    - "exception"
    - "failure"
    - "issue"
    - "problem"

# Entity relationships for iterative exploration
relationships:
  cm:
    - md_id
    - rpdname
    - sf_id
  
  md_id:
    - cm
    - rpdname
    - package
    - downstream_channel
    - sf_id
  
  cpe:
    - cm
    - md_id
    - rpdname
  
  rpdname:
    - cm
    - md_id
    - sf_id
  
  package:
    - md_id
    - service_group
    - billing_account
  
  error:
    - timestamp
    - severity
    - module
    - entity_id

# Entity extraction patterns (regex)
patterns:
  cm:
    - "CM\\d{4,6}"
    - "modem[_\\s]*(\\d+)"
  
  md_id:
    - "\"MdId\"\\s*:\\s*\"(0x[0-9a-fA-F]+)\""
    - "MdId[:\\s]*(\\d+)"
    - "modem_id[:\\s]*(\\d+)"
  
  cpe_mac:
    - "\"CpeMacAddress\"\\s*:\\s*\"([0-9a-fA-F]{2}:[0-9a-fA-F]{2}:[0-9a-fA-F]{2}:[0-9a-fA-F]{2}:[0-9a-fA-F]{2}:[0-9a-fA-F]{2})\""
    - "CpeMacAddress[:\\s]*([0-9a-fA-F]{2}:[0-9a-fA-F]{2}:[0-9a-fA-F]{2}:[0-9a-fA-F]{2}:[0-9a-fA-F]{2}:[0-9a-fA-F]{2})"
  
  cpe_ip:
    - "\"CpeIpAddress\"\\s*:\\s*\"([0-9a-fA-F:]+)\""
    - "CpeIpAddress[:\\s]*([0-9a-fA-F:]+)"
  
  cm_mac:
    - "\"CmMacAddress\"\\s*:\\s*\"([0-9a-fA-F]{2}:[0-9a-fA-F]{2}:[0-9a-fA-F]{2}:[0-9a-fA-F]{2}:[0-9a-fA-F]{2}:[0-9a-fA-F]{2})\""
    - "CmMacAddress[:\\s]*([0-9a-fA-F]{2}:[0-9a-fA-F]{2}:[0-9a-fA-F]{2}:[0-9a-fA-F]{2}:[0-9a-fA-F]{2}:[0-9a-fA-F]{2})"
  
  rpdname:
    - "\"RpdName\"\\s*:\\s*\"([A-Za-z0-9_-]+)\""
    - "RpdName[:\\s]*([A-Za-z0-9_-]+)"
    - "rpd[_\\s]*name[:\\s]*([A-Za-z0-9_-]+)"
  
  sf_id:
    - "\"SfIds\"\\s*:\\s*\\[\"(0x[0-9a-fA-F]+)\""
    - "SfId[:\\s]*(0x[0-9a-fA-F]+)"
    - "sf[_\\s]*id[:\\s]*(0x[0-9a-fA-F]+)"
  
  mac_address:
    - "([0-9A-Fa-f]{2}[:-][0-9A-Fa-f]{2}[:-][0-9A-Fa-f]{2}[:-][0-9A-Fa-f]{2}[:-][0-9A-Fa-f]{2}[:-][0-9A-Fa-f]{2})"
  
  ip_address:
    - "\\b(?:[0-9]{1,3}\\.){3}[0-9]{1,3}\\b"
    - "\\b(?:[0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}\\b"
  
  timestamp:
    - "\\d{4}-\\d{2}-\\d{2}\\s\\d{2}:\\d{2}:\\d{2}"
